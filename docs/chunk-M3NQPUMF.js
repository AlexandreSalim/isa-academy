import{a as L}from"./chunk-5EN5JPW4.js";import{a as A}from"./chunk-RXANTCD7.js";import{a as j}from"./chunk-W47MTIFR.js";import{d as h}from"./chunk-4ZJJULEX.js";import"./chunk-4WFVMWDK.js";import"./chunk-6AA45M3Q.js";import"./chunk-BUMFG4TH.js";import{Aa as g,Ba as n,Ca as a,Cb as F,Da as c,Dc as z,F as p,Fb as v,Ja as b,Ta as O,Wa as o,Xa as d,Ya as _,_b as I,ca as s,eb as w,ec as E,fb as S,ha as f,jc as N,la as C,lc as D,ma as u,qb as y,sb as k,tb as x,v as P}from"./chunk-7CCGUGHH.js";import"./chunk-RXU6FXFV.js";import"./chunk-QUJFQN2Y.js";import"./chunk-5ZPGBBWK.js";import"./chunk-QXMKMSGY.js";import"./chunk-NALLYM7I.js";import"./chunk-7FY2OE2O.js";import"./chunk-65BBGSFQ.js";import"./chunk-QQLTGCAV.js";import"./chunk-ALBQWLJW.js";import"./chunk-QNP3ESGV.js";import"./chunk-LH2JMB2Q.js";import"./chunk-FEMRQVRA.js";import"./chunk-KNB6ZRNH.js";import"./chunk-CWORV2KJ.js";import"./chunk-I7UTH7EM.js";import"./chunk-JU35B3CI.js";import"./chunk-42C7ZIID.js";import"./chunk-S3A63TT4.js";import"./chunk-OUUJBBTF.js";import"./chunk-AAAA5EP5.js";import"./chunk-MTHZ7MWU.js";import"./chunk-WI5MSH4N.js";import"./chunk-DDCYHNBE.js";import"./chunk-CKP3SGE2.js";import"./chunk-UJJLNTQI.js";import"./chunk-JHI3MBHO.js";var K=(()=>{let r=class r{constructor(t,e,i,m){this.draftService=t,this.studentsService=e,this.navCtrl=i,this.router=m,this.draft=null,this.saving=!1,this.imc=0,this.imcLabel="",this.weightRange="",this.density="",this.fatPercent=null,this.fatLabel="",this.leanMassKg="",this.leanMassPct="",this.studentFromApi=null}ngOnInit(){this.draftSub=this.draftService.getDraft$().subscribe(t=>{if(this.draft=t,!this.draft)return;let e=Number(this.draft?.user_id)||null;e?!this.studentFromApi||this.studentFromApi?.id!==e?this.studentsService.getOne(e).pipe(P(1)).subscribe({next:i=>{this.studentFromApi=i,this.populateFromDraft()},error:()=>{this.populateFromDraft()}}):this.populateFromDraft():this.populateFromDraft()})}ngOnDestroy(){this.draftSub?.unsubscribe()}parseNumber(t){if(t==null||t==="")return null;let e=Number(String(t).replace(",","."));return Number.isFinite(e)?e:null}parseHeightMeters(t){let e=this.parseNumber(t);return e===null?null:e>3?e/100:e}computeAgeFromDob(t){if(!t)return null;let e=new Date(t);if(isNaN(e.getTime()))return null;let i=new Date,m=i.getFullYear()-e.getFullYear(),M=i.getMonth()-e.getMonth();return(M<0||M===0&&i.getDate()<e.getDate())&&m--,m}densityFrom7Site(t,e,i){return i==="M"?1.112-43499e-8*t+55e-8*(t*t)-28826e-8*e:1.097-46971e-8*t+56e-8*(t*t)-12828e-8*e}densityFrom3Site(t,e,i){return i==="M"?1.10938-8267e-7*t+16e-7*(t*t)-2574e-7*e:1.0994921-9929e-7*t+23e-7*(t*t)-1392e-7*e}fatFromDensity(t){return!t||t<=0?NaN:495/t-450}populateFromDraft(){let t=L(this.draft??{},this.studentFromApi);if(this.imc=t.imcVal??this.parseNumber(this.draft?.imcValue)??0,this.imcLabel=this.getImcLabel(this.imc),t.altura){let e=18.5*t.altura*t.altura,i=24.9*t.altura*t.altura;this.weightRange=`${Math.round(e)}kg e ${Math.round(i)}kg`}else this.weightRange=this.draft?.weightRange??"\u2014";this.density=t.densidadeStr??this.draft?.density??"\u2014",this.fatPercent=t.fatPercentNum!==null?+t.fatPercentNum.toFixed(2):null,this.fatLabel=this.fatPercent!==null?this.getFatLabel(this.fatPercent):"",t.leanKg!==null?(this.leanMassKg=`${t.leanKg.toFixed(1)} kg`,this.leanMassPct=t.leanPctStr):(this.leanMassKg=this.draft?.leanMassKg??"\u2014",this.leanMassPct=this.draft?.leanMassPct??"\u2014"),this.imc=+(this.imc?this.imc:0)}getImcLabel(t){return!t||t===0?"":t<18.5?"Magreza":t<25?"Normal":t<30?"Sobrepeso":"Obeso"}getFatLabel(t){return t==null?"":t<10?"baixo":t<20?"normal":t<25?"elevado":"alto"}imcPositionPercent(){return(Math.max(10,Math.min(40,this.imc||0))-10)/30*92+4}imcBadgeClass(){return this.imc<18.5?"imc-underline--low":this.imc<25?"imc-underline--normal":this.imc<30?"imc-underline--over":"imc-underline--high"}save(){if(!this.draft)return;let t=Number(this.draft.user_id);console.log(t,this.draft),this.saving=!0,console.log(t,this.draft),this.studentsService.createAssessment(this.draft).subscribe({next:e=>{console.log(t,this.draft),this.saving=!1,this.draftService.clear(),t?this.router.navigate(["/students/information",t]):this.navCtrl.back()},error:e=>{this.saving=!1,console.error("Erro ao salvar assessment",e),alert("Erro ao salvar avalia\xE7\xE3o")}})}goBackToEdit(){if(!this.draft)return;let t=Number(this.draft.studentId);t&&this.navCtrl.navigateForward(["/students/information",t,"new-assessment"])}};r.\u0275fac=function(e){return new(e||r)(f(A),f(j),f(E),f(F))},r.\u0275cmp=C({type:r,selectors:[["app-assessment-result"]],standalone:!1,decls:61,vars:16,consts:[[3,"title"],[1,"result-shell",3,"fullscreen"],[1,"result-main"],[1,"card","imc-card"],[1,"imc-top"],[1,"imc-title"],[1,"imc-value"],[1,"imc-number"],[1,"imc-badge",3,"ngClass"],[1,"imc-bar-wrapper"],[1,"imc-bar"],["name","caret-down-outline",1,"imc-pointer"],[1,"triangle"],[1,"cards-list"],[1,"detail-card"],[1,"detail-left"],["src","/assets/icon/abdomi.png"],[1,"detail-label"],[1,"detail-value"],["src","/assets/icon/balan\xE7a.png"],["src","/assets/icon/percentualDeGordura.png"],[1,"fat-label"],[1,"two-cards"],[1,"mini-card"],[1,"mini-icon"],["src","/assets/icon/bra\xE7o.png"],[1,"mini-title"],[1,"mini-value"],["src","/assets/icon/corpo.png"],[1,"actions"],["fill","outline",1,"btn-cancel",3,"click"],[1,"btn-save",3,"click"]],template:function(e,i){e&1&&(c(0,"app-header",0),n(1,"ion-content",1)(2,"main",2)(3,"section",3)(4,"div",4)(5,"div",5),o(6,"\xCDndice de Massa Corporal (IMC)"),a(),n(7,"div",6)(8,"span",7),o(9),w(10,"number"),a(),n(11,"span",8),o(12),a()()(),n(13,"div",9),c(14,"div",10)(15,"ion-icon",11)(16,"div",12),a()(),n(17,"section",13)(18,"div",14)(19,"div",15),c(20,"img",16),n(21,"div",17),o(22,"Peso ideal"),a()(),n(23,"div",18),o(24),a()(),n(25,"div",14)(26,"div",15),c(27,"img",19),n(28,"div",17),o(29,"Dens. corporal"),a()(),n(30,"div",18),o(31),a()(),n(32,"div",14)(33,"div",15),c(34,"img",20),n(35,"div",17),o(36,"Percentual de gordura"),a()(),n(37,"div",18),o(38),n(39,"span",21),o(40),a()()()(),n(41,"section",22)(42,"div",23)(43,"div",24),c(44,"img",25),a(),n(45,"div",26),o(46,"Massa magra"),a(),n(47,"div",27),o(48),a()(),n(49,"div",23)(50,"div",24),c(51,"img",28),a(),n(52,"div",26),o(53,"Massa gorda"),a(),n(54,"div",27),o(55),a()()(),n(56,"section",29)(57,"button",30),b("click",function(){return i.goBackToEdit()}),o(58,"Editar"),a(),n(59,"button",31),b("click",function(){return i.save()}),o(60,"Salvar resultado"),a()()()()),e&2&&(g("title","Resultado"),s(),g("fullscreen",!0),s(8),d(S(10,13,i.imc,"1.1-1")),s(2),g("ngClass",i.imcBadgeClass()),s(),d(i.imcLabel),s(3),O("left",i.imcPositionPercent(),"%"),s(9),d(i.weightRange),s(7),d(i.density),s(7),_(" ",i.fatPercent," "),s(2),d(i.fatLabel),s(8),d(i.leanMassKg),s(7),d(i.leanMassPct))},dependencies:[y,N,D,h,k],styles:['@charset "UTF-8";[_nghost-%COMP%]{display:block}.result-shell[_ngcontent-%COMP%]{--background: #f2f2f2}.result-main[_ngcontent-%COMP%]{padding:20px;max-width:720px;margin:0 auto;font-family:Montserrat,sans-serif!important}.imc-card[_ngcontent-%COMP%]{background:#fff;padding:18px;border-radius:12px;box-shadow:0 6px 18px #020b2a0f;margin-bottom:16px}.imc-top[_ngcontent-%COMP%]{display:flex;justify-content:space-between;align-items:center;flex-direction:column}.imc-title[_ngcontent-%COMP%]{font-size:16px;color:#0b223f;font-weight:600}.imc-value[_ngcontent-%COMP%]{display:flex;align-items:center;gap:10px}.imc-number[_ngcontent-%COMP%]{font-size:48px;font-weight:700;color:#062143}.imc-badge[_ngcontent-%COMP%]{font-size:12px;padding:6px 10px;border-radius:14px;color:#fff;font-weight:700}.imc-underline--low[_ngcontent-%COMP%]{background:#2cb1ff}.imc-underline--normal[_ngcontent-%COMP%]{background:#3bbf6e}.imc-underline--over[_ngcontent-%COMP%]{background:#f0b429}.imc-underline--high[_ngcontent-%COMP%]{background:#e74c3c}.imc-bar-wrapper[_ngcontent-%COMP%]{position:relative;margin-top:14px;padding:8px 0 0}.imc-bar[_ngcontent-%COMP%]{height:10px;border-radius:10px;background:linear-gradient(90deg,#2db9ff,#6ad07a 25%,#ffbf40 55%,#ff9a2f 75%,#e74c3c);width:100%}.imc-pointer[_ngcontent-%COMP%]{position:absolute;top:-8px;transform:translate(-50%);display:flex;align-items:center;justify-content:center;color:#000;font-size:20px}.imc-pointer[_ngcontent-%COMP%]   .triangle[_ngcontent-%COMP%]{width:0;height:0;border-left:8px solid transparent;border-right:8px solid transparent;border-bottom:10px solid #fff;filter:drop-shadow(0 2px 2px rgba(0,0,0,.1))}.cards-list[_ngcontent-%COMP%]{display:flex;flex-direction:column;gap:10px;margin-bottom:14px}.detail-card[_ngcontent-%COMP%]{background:#fff;padding:14px;border-radius:10px;display:flex;justify-content:space-between;align-items:center;box-shadow:0 4px 10px #020b2a0a}.detail-left[_ngcontent-%COMP%]{display:flex;align-items:center;gap:12px;color:#062143}.detail-left[_ngcontent-%COMP%]   ion-icon[_ngcontent-%COMP%]{font-size:22px}.detail-label[_ngcontent-%COMP%]{font-weight:700;font-size:16px}.detail-value[_ngcontent-%COMP%]{color:#062143;font-weight:700;font-size:18px}.detail-value[_ngcontent-%COMP%]   span[_ngcontent-%COMP%]{margin:0;display:block;font-size:12px}.fat-label[_ngcontent-%COMP%]{display:inline-block;color:#f39c12;font-weight:700;margin-left:8px}.two-cards[_ngcontent-%COMP%]{display:grid;grid-template-columns:1fr 1fr;gap:12px;margin-bottom:18px}.mini-card[_ngcontent-%COMP%]{background:#fff;padding:14px;border-radius:10px;text-align:center;box-shadow:0 6px 14px #020b2a0a}.mini-icon[_ngcontent-%COMP%]{font-size:28px;color:#062143;margin-bottom:8px}.mini-icon[_ngcontent-%COMP%]   ion-icon[_ngcontent-%COMP%]{font-size:40px}.mini-title[_ngcontent-%COMP%]{font-size:16px;color:#062143}.mini-value[_ngcontent-%COMP%]{font-weight:800;font-size:20px;margin-top:6px;color:#000}.actions[_ngcontent-%COMP%]{display:flex;gap:12px;margin-top:12px;justify-content:center}.btn-cancel[_ngcontent-%COMP%]{background:#fff;border:1.6px solid #20263f;color:#00061c;width:120px;padding:12px 14px;border-radius:10px;font-weight:600;border:none}.btn-save[_ngcontent-%COMP%]{background:#07102a;color:#fff;width:180px;padding:12px 14px;border-radius:10px;font-weight:600;border:none}']});let l=r;return l})();var B=[{path:"",component:K}],T=(()=>{let r=class r{};r.\u0275fac=function(e){return new(e||r)},r.\u0275mod=u({type:r}),r.\u0275inj=p({imports:[v.forChild(B),v]});let l=r;return l})();var st=(()=>{let r=class r{};r.\u0275fac=function(e){return new(e||r)},r.\u0275mod=u({type:r}),r.\u0275inj=p({imports:[x,I,z,T,x,h]});let l=r;return l})();export{st as AssessmentResultPageModule};
