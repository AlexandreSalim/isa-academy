import{a as r}from"./chunk-ZNPQLLMD.js";import{C as $,E as b,H as k,d as f,j as a,k as p,t as u,yb as x}from"./chunk-7CCGUGHH.js";import{a as m,b as _}from"./chunk-JHI3MBHO.js";var E=(()=>{let o=class o{constructor(t){this.http=t,this.api=r.apiUrl+"/users/users.php",this.subj=new f([])}getAll(){return this.subj.asObservable()}getSnapshot(){return this.subj.value}getById(t){return this.getSnapshot().find(e=>e.id===Number(t))}getOne(t){return this.http.get(`${this.api}?id=${t}`).pipe(p(e=>{let s=e&&e.success!==void 0&&e.data!==void 0?e.data:e;return this.enrichStudent(s)}),u(e=>(console.error("Erro getOne:",e),a(()=>e))))}loadFromServer(){return this.http.get(this.api).pipe(p(t=>{let e=t&&t.success!==void 0&&t.data!==void 0?t.data:t;return(Array.isArray(e)?e:[]).map(i=>this.enrichStudent(i))}),$(t=>this.subj.next(t)),u(t=>(console.error("Erro ao buscar usu\xE1rios",t),a(()=>t))))}computeAge(t){let e=new Date,s=e.getFullYear()-t.getFullYear(),i=e.getMonth()-t.getMonth();return(i<0||i===0&&e.getDate()<t.getDate())&&s--,s}parseDate(t){if(!t)return null;if(t instanceof Date&&!isNaN(t.getTime()))return t;if(typeof t=="number"){let e=new Date(t);return isNaN(e.getTime())?null:e}if(typeof t=="string"){let e=t.trim(),s=e.match(/^(\d{4})-(\d{2})-(\d{2})/);if(s){let n=Number(s[1]),d=Number(s[2])-1,l=Number(s[3]),c=new Date(n,d,l);return isNaN(c.getTime())?null:c}let i=Date.parse(e);if(!isNaN(i)){let n=new Date(i);return isNaN(n.getTime())?null:n}}return null}enrichStudent(t){let e=m({},t||{}),s=t.date_of_birth??t.dateOfBirth??t.dob??t.nascimento??null,i=this.parseDate(s);if(i)e.date_of_birth=this.formatDateToDMY(i),e._date_of_birth_obj=i,e.age=this.computeAge(i);else{if(typeof s=="string"){let n=s.match(/^(\d{4})-(\d{2})-(\d{2})/);if(n){let d=Number(n[1]),l=Number(n[2])-1,c=Number(n[3]),h=new Date(d,l,c);if(!isNaN(h.getTime()))return e.date_of_birth=this.formatDateToDMY(h),e._date_of_birth_obj=h,e.age=this.computeAge(h),e}}e.date_of_birth=s??null,e.age=void 0}return e}formatDateToDMY(t){let e=String(t.getDate()).padStart(2,"0"),s=String(t.getMonth()+1).padStart(2,"0"),i=String(t.getFullYear());return`${e}/${s}/${i}`}create(t){return this.http.post(`${r.apiUrl}/users/create_user.php`,t)}update(t,e){let s=_(m({},e),{id:t});return this.http.post(`${r.apiUrl}/users/update_user.php`,s)}createAssessment(t){return this.http.post(`${r.apiUrl}/assessment/create_assessment.php`,t)}getAssessments(t){return this.http.get(`${r.apiUrl}/assessment/get_assessments.php?user_id=${t}`).pipe(p(e=>e&&e.success!==void 0&&e.data!==void 0?e.data:e),u(e=>(console.error("Erro ao buscar assessments",e),a(()=>e))))}getAssessment(t){return this.http.get(`${r.apiUrl}/assessment/get_assessment.php?id=${t}`).pipe(p(e=>e&&e.success!==void 0&&e.data!==void 0?e.data:e),u(e=>(console.error("Erro ao buscar assessment",e),a(()=>e))))}createWorkout(t){return this.http.post(`${r.apiUrl}/trainings/workouts
/create_workout.php`,t)}getWorkout(t){return this.http.get(`${r.apiUrl}/trainings/workouts
/get_workout.php?user_id=${t}`)}createMuscleGroups(t){return this.http.post(`${r.apiUrl}/trainings/muscle_groups/create_muscle_groups.php`,t)}getAllMuscleGroups(){return this.http.get(`${r.apiUrl}/trainings/muscle_groups/get_muscle_groups.php`)}getByIdMuscleGroups(t){return this.http.get(`${r.apiUrl}/trainings/muscle_groups/get_muscle_groups.php?id=${t}`)}createExercises(t){return this.http.post(`${r.apiUrl}/trainings/exercises/create_exercises.php`,t)}getExercisesByMuscleGroup(t){return this.http.get(`${r.apiUrl}/trainings/exercises/get_exercises.php?muscle_group_id=${t}`)}getAllExercises(){return this.http.get(`${r.apiUrl}/trainings/exercises/get_exercises.php`)}createWorkoutExercise(t){return this.http.post(`${r.apiUrl}/trainings/workout_exercises/create_workout_exercise.php`,t)}getWorkoutExercises(t){return this.http.get(`${r.apiUrl}/trainings/workout_exercises/get_workout_exercises.php?workout_id=${t}`)}getWorkoutExerciseById(t){return this.http.get(`${r.apiUrl}/trainings/workout_exercises/get_workout_exercises.php?id=${t}`)}deleteSerie(t,e){return this.http.delete(`${r.apiUrl}/trainings/workout_exercises/delete_serie.php`,{params:{workout_id:t.toString(),serie:e}})}deleteCompleteWorkout(t){return this.http.delete(`${r.apiUrl}/trainings/workout_exercises/delete_workout.php`,{params:{workout_id:t.toString()}})}deleteWorkoutExercise(t){return this.http.delete(`${r.apiUrl}/trainings/workout_exercises/delete_workout_exercise.php?id=${t}`)}updateWorkoutExercise(t){return this.http.put(`${r.apiUrl}/trainings/workout_exercises/update_workout_exercise.php`,t)}createTrainings(t){return this.http.post(`${r.apiUrl}/trainings/create.php`,t)}getTrainings(t){return this.http.get(`${r.apiUrl}/trainings/get.php?student_id=${t}`)}deleteTraining(t,e){let s=`${r.apiUrl}/trainings/delete.php`,i={student_id:t,id:e};return this.http.post(s,i)}updateTraining(t){let e=`${r.apiUrl}/trainings/update.php`;return this.http.post(e,t)}};o.\u0275fac=function(e){return new(e||o)(k(x))},o.\u0275prov=b({token:o,factory:o.\u0275fac,providedIn:"root"});let g=o;return g})();export{E as a};
